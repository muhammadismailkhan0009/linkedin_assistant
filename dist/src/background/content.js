(()=>{class e{async getAuthToken(){return new Promise(e=>{chrome.storage.local.get(["token"],t=>{e(t.token??null)})})}async getInstallId(){return new Promise(e=>{chrome.storage.local.get(["installId"],t=>{e(t.installId??null)})})}async generatePost(e){try{let t=await this.getAuthTokenAndInstallerId(),n=await fetch("https://api.wanderlytics.me/linkedin/api/v1/create-post",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${t.token}`},body:JSON.stringify({payload:{idea:e},additionalMetadata:{installId:t.installId}})});if(!n.ok)throw Error(`Backend error: ${n.status}`);let o=await n.json();return console.log("✅ post received from backend:",o),o}catch(e){return console.error("❌ Failed to send post to backend:",e),null}}async getAuthTokenAndInstallerId(){let e=await this.getAuthToken(),t=await this.getInstallId();if(!e||!t)throw Error("Missing auth token or install ID");return{token:e,installId:t}}async sendPostToBackend(e,t){try{let n=await this.getAuthTokenAndInstallerId(),o=await fetch("https://api.wanderlytics.me/linkedin/api/v1/create-comment",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${n.token}`},body:JSON.stringify({payload:{scrappedPost:e,url:t},additionalMetadata:{installId:n.installId}})});if(!o.ok)throw Error(`Backend error: ${o.status}`);let a=await o.json();return console.log("✅ Comment received from backend:",a),a}catch(e){return console.error("❌ Failed to send post to backend:",e),null}}}async function t(){console.log("⏳ [Scraper] Waiting for DOM to load..."),"loading"===document.readyState?(await new Promise(e=>document.addEventListener("DOMContentLoaded",e)),console.log("✅ [Scraper] DOM fully loaded.")):console.log("✅ [Scraper] DOM was already ready.");let e=await function(e,t=1e4){return new Promise(n=>{let o=Date.now(),a=setInterval(()=>{let r=Date.now()-o,l=document.querySelector(e);l&&(console.log("✅ [Scraper] Found post text element."),clearInterval(a),n(l.innerText.trim())),r>=t&&(console.warn("⚠️ [Scraper] Timeout: Post text not found."),clearInterval(a),n(null))},500)})}('.update-components-update-v2__commentary span[dir="ltr"]');if(e)return e;throw console.error("❌ [Scraper] Failed to find or extract post text."),Error("post could not be extracted")}async function n(e,t){if(!t)return;let n=`comment-${t}`;await chrome.storage.local.set({[n]:e}),console.log("comment stored:"+e)}async function o(){chrome.runtime.sendMessage({type:"SET_BADGE",status:"loading"});let o=window.location.href,a=await t();n((await new e().sendPostToBackend(a,"")).payload,o),chrome.runtime.sendMessage({type:"SET_BADGE",status:"ready"})}console.log("✅ [LinkedIn Scraper] Content script injected."),o()})();
//# sourceMappingURL=content.js.map
